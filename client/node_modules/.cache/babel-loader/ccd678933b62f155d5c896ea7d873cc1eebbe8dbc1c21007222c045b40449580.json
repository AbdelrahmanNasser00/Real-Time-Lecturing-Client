{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../../api\";\nimport { openAlertMessage } from \"./alertSlice\";\nexport const authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    userDetails: null\n  },\n  reducers: {\n    setUserDetails: (state, action) => {\n      state.setUserDetails = action.payload;\n    },\n    setUnverifiedUserDetails: (state, action) => {\n      state.setVerifiedUserDetails = action.payload;\n    }\n  }\n});\nexport const login = createAsyncThunk(\"auth/login\", async ({\n  userDetails,\n  history\n}, {\n  dispatch\n}) => {\n  try {\n    const response = await api.login(userDetails);\n    const {\n      userDetails\n    } = response === null || response === void 0 ? void 0 : response.data;\n    localStorage.setItem(\"user\", JSON.stringify(userDetails));\n    dispatch(setUserDetails(userDetails));\n    history.push(\"/dashboard\");\n    return userDetails;\n  } catch (error) {\n    dispatch(openAlertMessage(\"Login failed\"));\n  }\n});\nexport const register = createAsyncThunk(\"auth/register\", async (userDetails, dispatch) => {\n  try {\n    const response = await api.register(userDetails);\n    const {\n      userDetails\n    } = response === null || response === void 0 ? void 0 : response.data;\n    localStorage.setItem(\"unverifiedUser\", JSON.stringify(userDetails));\n    console.log(\"register actoin\", localStorage.getItem(\"unverifiedUser\"));\n    dispatch(setVerifiedUserDetails(userDetails));\n    return userDetails;\n  } catch (error) {\n    dispatch(openAlertMessage(\"Registration failed\"));\n  }\n});\nexport const verify = createAsyncThunk(\"auth/verify\", async ({\n  userDetails,\n  history\n}, {\n  dispatch,\n  rejectWithValue\n}) => {\n  try {\n    const response = await api.verify(userDetails);\n    const {\n      userDetails\n    } = response.data;\n    localStorage.setItem(\"user\", JSON.stringify(userDetails));\n    dispatch(setUserDetails(userDetails));\n    history.push(\"/dashboard\");\n    return userDetails;\n  } catch (error) {\n    dispatch(openAlertMessage(\"Verification failed\"));\n    return rejectWithValue(error.message);\n  }\n});\nexport const {\n  setUserDetails,\n  setVerifiedUserDetails\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","api","openAlertMessage","authSlice","name","initialState","userDetails","reducers","setUserDetails","state","action","payload","setUnverifiedUserDetails","setVerifiedUserDetails","login","history","dispatch","response","data","localStorage","setItem","JSON","stringify","push","error","register","console","log","getItem","verify","rejectWithValue","message","actions","reducer"],"sources":["/home/abdelrahman/Documents/Realtime-project/client/Real-Time-Lecturing-Client/client/src/store/authSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../../api\";\nimport { openAlertMessage } from \"./alertSlice\";\n\nexport const authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    userDetails: null,\n  },\n  reducers: {\n    setUserDetails: (state, action) => {\n      state.setUserDetails = action.payload;\n    },\n    setUnverifiedUserDetails: (state, action) => {\n      state.setVerifiedUserDetails = action.payload;\n    },\n  },\n});\n\nexport const login = createAsyncThunk(\n  \"auth/login\",\n  async ({ userDetails, history }, { dispatch }) => {\n    try {\n      const response = await api.login(userDetails);\n      const { userDetails } = response?.data;\n      localStorage.setItem(\"user\", JSON.stringify(userDetails));\n      dispatch(setUserDetails(userDetails));\n      history.push(\"/dashboard\");\n      return userDetails;\n    } catch (error) {\n      dispatch(openAlertMessage(\"Login failed\"));\n    }\n  }\n);\n\nexport const register = createAsyncThunk(\n  \"auth/register\",\n  async (userDetails, dispatch) => {\n    try {\n      const response = await api.register(userDetails);\n      const { userDetails } = response?.data;\n      localStorage.setItem(\"unverifiedUser\", JSON.stringify(userDetails));\n      console.log(\"register actoin\", localStorage.getItem(\"unverifiedUser\"));\n      dispatch(setVerifiedUserDetails(userDetails));\n      return userDetails;\n    } catch (error) {\n      dispatch(openAlertMessage(\"Registration failed\"));\n    }\n  }\n);\n\nexport const verify = createAsyncThunk(\n  \"auth/verify\",\n  async ({ userDetails, history }, { dispatch, rejectWithValue }) => {\n    try {\n      const response = await api.verify(userDetails);\n      const { userDetails } = response.data;\n      localStorage.setItem(\"user\", JSON.stringify(userDetails));\n      dispatch(setUserDetails(userDetails));\n      history.push(\"/dashboard\");\n      return userDetails;\n    } catch (error) {\n      dispatch(openAlertMessage(\"Verification failed\"));\n      return rejectWithValue(error.message);\n    }\n  }\n);\n\nexport const { setUserDetails, setVerifiedUserDetails } = authSlice.actions;\n\nexport default authSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}