{"ast":null,"code":"import io from \"socket.io-client\";\nimport { setSubjects } from \"../store/actions/subjectsActions\";\nimport { setPendingFriendsInvitations, setFriends, setOnlineUsers } from \"../store/actions/friendsActions\";\nimport store from \"../store/store\";\nimport * as roomHandler from \"./roomHandler\";\nimport * as webRTCHandler from \"./webRTCHandler\";\nlet socket = null;\nexport const connectWithSocketServer = userDetails => {\n  console.log(userDetails);\n  console.log(\"email \", userDetails.mail);\n  console.log(\"toked\", userDetails.token);\n  const jwtToken = userDetails.token;\n  console.log(\"jwtTokec: \", jwtToken);\n  console.log(\"connecting...\");\n  socket = io(\"http://localhost:8080\", {\n    auth: {\n      token: jwtToken\n    }\n  });\n  socket.on(\"connect\", () => {\n    console.log(\"succesfully connected with socket.io server\");\n    console.log(socket.id);\n  });\n  socket.on(\"friends-invitations\", data => {\n    const {\n      pendingInvitations\n    } = data;\n    store.dispatch(setPendingFriendsInvitations(pendingInvitations));\n  });\n  socket.on(\"friends-list\", data => {\n    console.log(data);\n    store.dispatch(setSubjects(data));\n    // store.dispatch(setFriends(data));\n  });\n  socket.on(\"online-users\", data => {\n    const {\n      onlineUsers\n    } = data;\n    // store.dispatch(setOnlineUsers(onlineUsers));\n  });\n  socket.on(\"create-room\", data => {\n    roomHandler.newRoomCreated(data);\n  });\n  socket.on(\"active-rooms\", data => {\n    roomHandler.updateActiveRooms(data);\n  });\n  socket.on(\"conn-prepare\", data => {\n    const {\n      connUserSocketId\n    } = data;\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, false);\n    socket.emit(\"initialze-connection\", {\n      connUserSocketId: connUserSocketId\n    });\n  });\n  socket.on(\"initialze-connection\", data => {\n    const {\n      connUserSocketId\n    } = data;\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, true);\n  });\n  socket.on(\"conn-signal\", data => {\n    webRTCHandler.handleSignalingData(data);\n  });\n  socket.on(\"room-participant-left\", data => {\n    console.log(\"user left room\");\n    webRTCHandler.handleParticipantLeftRoom(data);\n  });\n  socket.on(\"3loosh\", data => {\n    console.log(\"3loosh\");\n    console.log(data);\n  });\n};\nexport const createNewRoom = () => {\n  socket.emit(\"create-room\");\n};\nexport const joinRoom = data => {\n  socket.emit(\"join-room\", data);\n};\nexport const leaveRoom = data => {\n  socket.emit(\"leave-room\", data);\n};\nexport const signalPeerData = data => {\n  socket.emit(\"conn-signal\", data);\n};","map":{"version":3,"names":["io","setSubjects","setPendingFriendsInvitations","setFriends","setOnlineUsers","store","roomHandler","webRTCHandler","socket","connectWithSocketServer","userDetails","console","log","mail","token","jwtToken","auth","on","id","data","pendingInvitations","dispatch","onlineUsers","newRoomCreated","updateActiveRooms","connUserSocketId","prepareNewPeerConnection","emit","handleSignalingData","handleParticipantLeftRoom","createNewRoom","joinRoom","leaveRoom","signalPeerData"],"sources":["/media/alaa-eldeen/D/Real-Time-Lecturing/Real-Time-Lecturing-Client/client/src/realtimeCommunication/socketConnection.js"],"sourcesContent":["import io from \"socket.io-client\";\r\nimport { setSubjects } from \"../store/actions/subjectsActions\";\r\nimport {\r\n  setPendingFriendsInvitations,\r\n  setFriends,\r\n  setOnlineUsers,\r\n} from \"../store/actions/friendsActions\";\r\nimport store from \"../store/store\";\r\nimport * as roomHandler from \"./roomHandler\";\r\nimport * as webRTCHandler from \"./webRTCHandler\";\r\n\r\nlet socket = null;\r\n\r\nexport const connectWithSocketServer = (userDetails) => {\r\n  console.log(userDetails);\r\n  console.log(\"email \", userDetails.mail);\r\n  console.log(\"toked\", userDetails.token);\r\n  const jwtToken = userDetails.token;\r\n  console.log(\"jwtTokec: \", jwtToken);\r\n  console.log(\"connecting...\");\r\n  socket = io(\"http://localhost:8080\", {\r\n    auth: {\r\n      token: jwtToken,\r\n    },\r\n  });\r\n\r\n  socket.on(\"connect\", () => {\r\n    console.log(\"succesfully connected with socket.io server\");\r\n    console.log(socket.id);\r\n  });\r\n\r\n  socket.on(\"friends-invitations\", (data) => {\r\n    const { pendingInvitations } = data;\r\n    store.dispatch(setPendingFriendsInvitations(pendingInvitations));\r\n  });\r\n\r\n  socket.on(\"friends-list\", (data) => {\r\n    console.log(data);\r\n    store.dispatch(setSubjects(data));\r\n    // store.dispatch(setFriends(data));\r\n  });\r\n\r\n  socket.on(\"online-users\", (data) => {\r\n    const { onlineUsers } = data;\r\n    // store.dispatch(setOnlineUsers(onlineUsers));\r\n  });\r\n\r\n  socket.on(\"create-room\", (data) => {\r\n    roomHandler.newRoomCreated(data);\r\n  });\r\n\r\n  socket.on(\"active-rooms\", (data) => {\r\n    roomHandler.updateActiveRooms(data);\r\n  });\r\n\r\n  socket.on(\"conn-prepare\", (data) => {\r\n    const { connUserSocketId } = data;\r\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, false);\r\n    socket.emit(\"initialze-connection\", { connUserSocketId: connUserSocketId });\r\n  });\r\n\r\n  socket.on(\"initialze-connection\", (data) => {\r\n    const { connUserSocketId } = data;\r\n    webRTCHandler.prepareNewPeerConnection(connUserSocketId, true);\r\n  });\r\n\r\n  socket.on(\"conn-signal\", (data) => {\r\n    webRTCHandler.handleSignalingData(data);\r\n  });\r\n\r\n  socket.on(\"room-participant-left\", (data) => {\r\n    console.log(\"user left room\");\r\n    webRTCHandler.handleParticipantLeftRoom(data);\r\n  });\r\n\r\n  socket.on(\"3loosh\", (data) => {\r\n    console.log(\"3loosh\");\r\n    console.log(data);\r\n  });\r\n};\r\n\r\nexport const createNewRoom = () => {\r\n  socket.emit(\"create-room\");\r\n};\r\n\r\nexport const joinRoom = (data) => {\r\n  socket.emit(\"join-room\", data);\r\n};\r\n\r\nexport const leaveRoom = (data) => {\r\n  socket.emit(\"leave-room\", data);\r\n};\r\n\r\nexport const signalPeerData = (data) => {\r\n  socket.emit(\"conn-signal\", data);\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}