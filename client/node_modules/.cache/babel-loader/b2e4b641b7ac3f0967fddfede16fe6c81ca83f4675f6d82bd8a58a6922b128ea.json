{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../api\";\nimport { openAlertMessage } from \"./alertSlice\";\nexport const authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    userDetails: null,\n    error: null,\n    loading: false\n  },\n  reducers: {\n    setUserDetails: (state, action) => {\n      state.setUserDetails = action.payload;\n    },\n    setUnverifiedUserDetails: (state, action) => {\n      state.setVerifiedUserDetails = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(login.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.loading = false;\n      state.userDetails = action.payload;\n    }).addCase(login.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.error.message;\n    });\n  }\n});\nexport const login = createAsyncThunk(\"auth/login\", async (userDetails, {\n  dispatch\n}) => {\n  console.log(userDetails);\n  const response = await api.login(userDetails);\n  if (response.error) {\n    dispatch(openAlertMessage(\"Login failed\"));\n  }\n  try {\n    const {\n      userDetails\n    } = response === null || response === void 0 ? void 0 : response.data;\n    localStorage.setItem(\"user\", JSON.stringify(userDetails));\n    dispatch(setUserDetails(userDetails));\n    return userDetails;\n  } catch (error) {}\n});\nexport const register = createAsyncThunk(\"auth/register\", async (userDetails, {\n  dispatch\n}) => {\n  try {\n    const response = await api.register(userDetails);\n    const {\n      userDetails\n    } = response === null || response === void 0 ? void 0 : response.data;\n    localStorage.setItem(\"unverifiedUser\", JSON.stringify(userDetails));\n    console.log(\"register actoin\", localStorage.getItem(\"unverifiedUser\"));\n    dispatch(setVerifiedUserDetails(userDetails));\n    return userDetails;\n  } catch (error) {\n    dispatch(openAlertMessage(\"Registration failed\"));\n  }\n});\nexport const verify = createAsyncThunk(\"auth/verify\", async (userDetails, history, {\n  dispatch\n}) => {\n  try {\n    const response = await api.verify(userDetails);\n    const {\n      userDetails\n    } = response.data;\n    localStorage.setItem(\"user\", JSON.stringify(userDetails));\n    dispatch(setUserDetails(userDetails));\n    history.push(\"/dashboard\");\n    return userDetails;\n  } catch (error) {\n    dispatch(openAlertMessage(\"Verification failed\"));\n  }\n});\nexport const {\n  setUserDetails,\n  setVerifiedUserDetails\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","api","openAlertMessage","authSlice","name","initialState","userDetails","error","loading","reducers","setUserDetails","state","action","payload","setUnverifiedUserDetails","setVerifiedUserDetails","extraReducers","builder","addCase","login","pending","fulfilled","rejected","message","dispatch","console","log","response","data","localStorage","setItem","JSON","stringify","register","getItem","verify","history","push","actions","reducer"],"sources":["/home/abdelrahman/Documents/Realtime-project/client/Real-Time-Lecturing-Client/client/src/store/authSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../api\";\nimport { openAlertMessage } from \"./alertSlice\";\n\nexport const authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    userDetails: null,\n    error: null,\n    loading: false,\n  },\n  reducers: {\n    setUserDetails: (state, action) => {\n      state.setUserDetails = action.payload;\n    },\n    setUnverifiedUserDetails: (state, action) => {\n      state.setVerifiedUserDetails = action.payload;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(login.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.loading = false;\n        state.userDetails = action.payload;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.error.message;\n      });\n  },\n});\n\nexport const login = createAsyncThunk(\n  \"auth/login\",\n  async (userDetails, { dispatch }) => {\n    console.log(userDetails);\n    const response = await api.login(userDetails);\n    if (response.error) {\n      dispatch(openAlertMessage(\"Login failed\"));\n    }\n    try {\n      const { userDetails } = response?.data;\n      localStorage.setItem(\"user\", JSON.stringify(userDetails));\n      dispatch(setUserDetails(userDetails));\n      return userDetails;\n    } catch (error) {}\n  }\n);\n\nexport const register = createAsyncThunk(\n  \"auth/register\",\n  async (userDetails, { dispatch }) => {\n    try {\n      const response = await api.register(userDetails);\n      const { userDetails } = response?.data;\n      localStorage.setItem(\"unverifiedUser\", JSON.stringify(userDetails));\n      console.log(\"register actoin\", localStorage.getItem(\"unverifiedUser\"));\n      dispatch(setVerifiedUserDetails(userDetails));\n      return userDetails;\n    } catch (error) {\n      dispatch(openAlertMessage(\"Registration failed\"));\n    }\n  }\n);\n\nexport const verify = createAsyncThunk(\n  \"auth/verify\",\n  async (userDetails, history, { dispatch }) => {\n    try {\n      const response = await api.verify(userDetails);\n      const { userDetails } = response.data;\n      localStorage.setItem(\"user\", JSON.stringify(userDetails));\n      dispatch(setUserDetails(userDetails));\n      history.push(\"/dashboard\");\n      return userDetails;\n    } catch (error) {\n      dispatch(openAlertMessage(\"Verification failed\"));\n    }\n  }\n);\n\nexport const { setUserDetails, setVerifiedUserDetails } = authSlice.actions;\n\nexport default authSlice.reducer;\n"],"mappings":"AAAA,SAASA,gBAAgB,EAAEC,WAAW,QAAQ,kBAAkB;AAChE,OAAO,KAAKC,GAAG,MAAM,QAAQ;AAC7B,SAASC,gBAAgB,QAAQ,cAAc;AAE/C,OAAO,MAAMC,SAAS,GAAGH,WAAW,CAAC;EACnCI,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZC,WAAW,EAAE,IAAI;IACjBC,KAAK,EAAE,IAAI;IACXC,OAAO,EAAE;EACX,CAAC;EACDC,QAAQ,EAAE;IACRC,cAAc,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;MACjCD,KAAK,CAACD,cAAc,GAAGE,MAAM,CAACC,OAAO;IACvC,CAAC;IACDC,wBAAwB,EAAEA,CAACH,KAAK,EAAEC,MAAM,KAAK;MAC3CD,KAAK,CAACI,sBAAsB,GAAGH,MAAM,CAACC,OAAO;IAC/C;EACF,CAAC;EACDG,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACC,KAAK,CAACC,OAAO,EAAGT,KAAK,IAAK;MACjCA,KAAK,CAACH,OAAO,GAAG,IAAI;MACpBG,KAAK,CAACJ,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDW,OAAO,CAACC,KAAK,CAACE,SAAS,EAAE,CAACV,KAAK,EAAEC,MAAM,KAAK;MAC3CD,KAAK,CAACH,OAAO,GAAG,KAAK;MACrBG,KAAK,CAACL,WAAW,GAAGM,MAAM,CAACC,OAAO;IACpC,CAAC,CAAC,CACDK,OAAO,CAACC,KAAK,CAACG,QAAQ,EAAE,CAACX,KAAK,EAAEC,MAAM,KAAK;MAC1CD,KAAK,CAACH,OAAO,GAAG,KAAK;MACrBG,KAAK,CAACJ,KAAK,GAAGK,MAAM,CAACL,KAAK,CAACgB,OAAO;IACpC,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAMJ,KAAK,GAAGpB,gBAAgB,CACnC,YAAY,EACZ,OAAOO,WAAW,EAAE;EAAEkB;AAAS,CAAC,KAAK;EACnCC,OAAO,CAACC,GAAG,CAACpB,WAAW,CAAC;EACxB,MAAMqB,QAAQ,GAAG,MAAM1B,GAAG,CAACkB,KAAK,CAACb,WAAW,CAAC;EAC7C,IAAIqB,QAAQ,CAACpB,KAAK,EAAE;IAClBiB,QAAQ,CAACtB,gBAAgB,CAAC,cAAc,CAAC,CAAC;EAC5C;EACA,IAAI;IACF,MAAM;MAAEI;IAAY,CAAC,GAAGqB,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEC,IAAI;IACtCC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAAC1B,WAAW,CAAC,CAAC;IACzDkB,QAAQ,CAACd,cAAc,CAACJ,WAAW,CAAC,CAAC;IACrC,OAAOA,WAAW;EACpB,CAAC,CAAC,OAAOC,KAAK,EAAE,CAAC;AACnB,CACF,CAAC;AAED,OAAO,MAAM0B,QAAQ,GAAGlC,gBAAgB,CACtC,eAAe,EACf,OAAOO,WAAW,EAAE;EAAEkB;AAAS,CAAC,KAAK;EACnC,IAAI;IACF,MAAMG,QAAQ,GAAG,MAAM1B,GAAG,CAACgC,QAAQ,CAAC3B,WAAW,CAAC;IAChD,MAAM;MAAEA;IAAY,CAAC,GAAGqB,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEC,IAAI;IACtCC,YAAY,CAACC,OAAO,CAAC,gBAAgB,EAAEC,IAAI,CAACC,SAAS,CAAC1B,WAAW,CAAC,CAAC;IACnEmB,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEG,YAAY,CAACK,OAAO,CAAC,gBAAgB,CAAC,CAAC;IACtEV,QAAQ,CAACT,sBAAsB,CAACT,WAAW,CAAC,CAAC;IAC7C,OAAOA,WAAW;EACpB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdiB,QAAQ,CAACtB,gBAAgB,CAAC,qBAAqB,CAAC,CAAC;EACnD;AACF,CACF,CAAC;AAED,OAAO,MAAMiC,MAAM,GAAGpC,gBAAgB,CACpC,aAAa,EACb,OAAOO,WAAW,EAAE8B,OAAO,EAAE;EAAEZ;AAAS,CAAC,KAAK;EAC5C,IAAI;IACF,MAAMG,QAAQ,GAAG,MAAM1B,GAAG,CAACkC,MAAM,CAAC7B,WAAW,CAAC;IAC9C,MAAM;MAAEA;IAAY,CAAC,GAAGqB,QAAQ,CAACC,IAAI;IACrCC,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAAC1B,WAAW,CAAC,CAAC;IACzDkB,QAAQ,CAACd,cAAc,CAACJ,WAAW,CAAC,CAAC;IACrC8B,OAAO,CAACC,IAAI,CAAC,YAAY,CAAC;IAC1B,OAAO/B,WAAW;EACpB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdiB,QAAQ,CAACtB,gBAAgB,CAAC,qBAAqB,CAAC,CAAC;EACnD;AACF,CACF,CAAC;AAED,OAAO,MAAM;EAAEQ,cAAc;EAAEK;AAAuB,CAAC,GAAGZ,SAAS,CAACmC,OAAO;AAE3E,eAAenC,SAAS,CAACoC,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}