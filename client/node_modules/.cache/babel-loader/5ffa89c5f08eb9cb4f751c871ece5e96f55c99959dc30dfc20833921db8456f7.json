{"ast":null,"code":"var _s = $RefreshSig$();\nimport { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../api\";\nimport { openAlertMessage } from \"./alertSlice\";\nimport { useHistory } from \"react-router-dom/cjs/react-router-dom.min\";\nexport const authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    userDetails: null,\n    error: null,\n    loading: false\n  },\n  reducers: {\n    setUserDetails: (state, action) => {\n      state.setUserDetails = action.payload;\n    },\n    setUnverifiedUserDetails: (state, action) => {\n      state.setVerifiedUserDetails = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(login.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.loading = false;\n      state.userDetails = action.payload;\n    }).addCase(login.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.error.message;\n    });\n  }\n});\nexport const login = _s(createAsyncThunk(\"auth/login\", _s(async ({\n  userDetails\n}, {\n  dispatch\n}) => {\n  _s();\n  const response = await api.login(userDetails);\n  console.log(response);\n  if (response.error) {\n    dispatch(openAlertMessage(\"Login failed\"));\n  } else {\n    const {\n      userDetails\n    } = response === null || response === void 0 ? void 0 : response.data;\n    console.log(\"userDetails\", userDetails);\n    localStorage.setItem(\"user\", JSON.stringify(userDetails));\n    dispatch(setUserDetails(userDetails));\n    const history = useHistory();\n    history.push(\"/dashboard\");\n  }\n}, \"9cZfZ04734qoCGIctmKX7+sX6eU=\", false, function () {\n  return [useHistory];\n})), \"9cZfZ04734qoCGIctmKX7+sX6eU=\", false, function () {\n  return [useHistory];\n});\nexport const register = createAsyncThunk(\"auth/register\", async (userDetails, {\n  dispatch\n}) => {\n  const response = await api.register(userDetails);\n  if (response.error) {\n    dispatch(openAlertMessage(\"Registeration failed\"));\n  } else {\n    const {\n      userDetails\n    } = response === null || response === void 0 ? void 0 : response.data;\n    localStorage.setItem(\"unverifiedUser\", JSON.stringify(userDetails));\n    console.log(\"register actoin\", localStorage.getItem(\"unverifiedUser\"));\n    dispatch(setVerifiedUserDetails(userDetails));\n  }\n});\nexport const verify = createAsyncThunk(\"auth/verify\", async (userDetails, history, {\n  dispatch\n}) => {\n  const response = await api.verify(userDetails);\n  if (response.error) {\n    dispatch(openAlertMessage(\"Verification failed\"));\n  } else {\n    const {\n      userDetails\n    } = response.data;\n    localStorage.setItem(\"user\", JSON.stringify(userDetails));\n    dispatch(setUserDetails(userDetails));\n    history.push(\"/dashboard\");\n  }\n});\nexport const {\n  setUserDetails,\n  setVerifiedUserDetails\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","api","openAlertMessage","useHistory","authSlice","name","initialState","userDetails","error","loading","reducers","setUserDetails","state","action","payload","setUnverifiedUserDetails","setVerifiedUserDetails","extraReducers","builder","addCase","login","pending","fulfilled","rejected","message","_s","dispatch","response","console","log","data","localStorage","setItem","JSON","stringify","history","push","register","getItem","verify","actions","reducer"],"sources":["/home/abdelrahman/Documents/Realtime-project/client/Real-Time-Lecturing-Client/client/src/store/authSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../api\";\nimport { openAlertMessage } from \"./alertSlice\";\nimport { useHistory } from \"react-router-dom/cjs/react-router-dom.min\";\n\nexport const authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    userDetails: null,\n    error: null,\n    loading: false,\n  },\n  reducers: {\n    setUserDetails: (state, action) => {\n      state.setUserDetails = action.payload;\n    },\n    setUnverifiedUserDetails: (state, action) => {\n      state.setVerifiedUserDetails = action.payload;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(login.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.loading = false;\n        state.userDetails = action.payload;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.error.message;\n      });\n  },\n});\n\nexport const login = createAsyncThunk(\n  \"auth/login\",\n  async ({ userDetails }, { dispatch }) => {\n    const response = await api.login(userDetails);\n    console.log(response);\n    if (response.error) {\n      dispatch(openAlertMessage(\"Login failed\"));\n    } else {\n      const { userDetails } = response?.data;\n      console.log(\"userDetails\", userDetails);\n      localStorage.setItem(\"user\", JSON.stringify(userDetails));\n      dispatch(setUserDetails(userDetails));\n      const history = useHistory();\n\n      history.push(\"/dashboard\");\n    }\n  }\n);\n\nexport const register = createAsyncThunk(\n  \"auth/register\",\n  async (userDetails, { dispatch }) => {\n    const response = await api.register(userDetails);\n    if (response.error) {\n      dispatch(openAlertMessage(\"Registeration failed\"));\n    } else {\n      const { userDetails } = response?.data;\n      localStorage.setItem(\"unverifiedUser\", JSON.stringify(userDetails));\n      console.log(\"register actoin\", localStorage.getItem(\"unverifiedUser\"));\n      dispatch(setVerifiedUserDetails(userDetails));\n    }\n  }\n);\n\nexport const verify = createAsyncThunk(\n  \"auth/verify\",\n  async (userDetails, history, { dispatch }) => {\n    const response = await api.verify(userDetails);\n    if (response.error) {\n      dispatch(openAlertMessage(\"Verification failed\"));\n    } else {\n      const { userDetails } = response.data;\n      localStorage.setItem(\"user\", JSON.stringify(userDetails));\n      dispatch(setUserDetails(userDetails));\n      history.push(\"/dashboard\");\n    }\n  }\n);\n\nexport const { setUserDetails, setVerifiedUserDetails } = authSlice.actions;\n\nexport default authSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}